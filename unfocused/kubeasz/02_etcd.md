## Setup the ETCD cluster

- Copy the etcd binary to the etcd node

- Generate etcd certificate and distribute the certificate to the etcd node
  - Genereate the etcd certificate from the CA. The signing request contains the IP addresses of the etcd nodes.
  - Distributes the CA certificate, etcd certificate and etcd key to `/etc/kubernetes/ssl` on each etcd node.

- Configure the systemctl script and start the etcd cluster.
  - The cluster information is automatically generated by kubeasz.

```shell
export NODE_IPS="192.168.1.1 192.168.1.2 192.168.1.3"
for ip in ${NODE_IPS}; do
  ETCDCTL_API=3 etcdctl \
  --endpoints=https://${ip}:2379  \
  --cacert=/etc/kubernetes/ssl/ca.pem \
  --cert=/etc/kubernetes/ssl/etcd.pem \
  --key=/etc/kubernetes/ssl/etcd-key.pem \
  endpoint health; done

for ip in ${NODE_IPS}; do
  ETCDCTL_API=3 etcdctl \
  --endpoints=https://${ip}:2379  \
  --cacert=/etc/kubernetes/ssl/ca.pem \
  --cert=/etc/kubernetes/ssl/etcd.pem \
  --key=/etc/kubernetes/ssl/etcd-key.pem \
  --write-out=table endpoint status; done
```

